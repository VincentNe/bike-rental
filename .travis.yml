language: java
jdk:
- oraclejdk8
services:
- postgresql
install:
- echo "Skip install step"
before_script:
- psql -c 'create database bikerental;' -U postgres
- cat .config/travis.application.properties > src/main/resources/application.properties
script:
- mvn clean package
- before_deploy:
    - cat .config/heroku.application.properties > src/main/resources/application.properties
    - echo "${DB_PASSWORD}" >> src/main/resources/application.properties
    - echo "${DB_URL}" >> src/main/resources/application.properties
    - echo "${DB_USERNAME}" >> src/main/resources/application.properties
    - echo "${TOKEN_SECRET}" >> src/main/resources/application.properties
after_success:
- bash <(curl -s https://codecov.io/bash)

deploy:
  provider: heroku
  api_key:
    secure: u4ddN6IHvEv1/cjnw38J2RJTOJ+Kv3B9zzc/j/7HmylEJKQyVF6ZBDa00quBHXtb6eoZhxaVkPVsFcs96i2dHqVx06Q6Dh3TD8iqdlBvnvU50mSbgww1irah1+8bMU81BcLB/U0Q3ZA+TUf8zjiZO2P8xZvT5Wel9YyLknVz/6StuEvCLzynb6d8fwwXEY2rAfRErFuyKI9ozwumrEDYkAcaVU2CfQSAA+xqHrrGDWZ3OcBmyXp10KTJAZXO/6hfkyB/HHckhEYKDsCXbJrJrUhH9UenFa6Up6s6VkvR+bFvh98kXX0ezTWhGGqJ7hLSOl+bE5dch8YSfPflc25mJImI7/NmFDCbuLmQ3nzCn1FKqoVE+/GxUsADrWadQ6FbZERCGrVEtuSN5BuPKkVNglI9ghlMILt12Jml00ywrHlz6TcKa+QFuXj0HaNNWPNEcWt8dTt+LwJM0i9kRXViy4y0WcXjDCWbG9qrM0/5JKfYeO4LaW8RYCswdWk7BUV4XI/2tzxTp0QxMOgzfUW/S0gY+DuA6g767oMdzESdWX4zbMRAUUABV6iht40vjFhinb4yAa4UkUhDfgagWAcq7Fb/EKNIaOUlflk5yNKDdFPFIDGNhBDHCLHoW7FdWNcmenFaEj3ytxEj/GYPYkKTJeONAgU+WyIABeKFjyS5RPk=
  on:
    branch: master

cache:
  directories:
    - "$HOME/.m2"
notifications:
  email: false